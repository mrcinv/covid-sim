(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    105210,       2658]
NotebookOptionsPosition[    104912,       2643]
NotebookOutlinePosition[    105268,       2659]
CellTagsIndexPosition[    105225,       2656]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"wmf", ",", "wjac", ",", "dwf", ",", "wf"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wmf", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"a", " ", 
    RowBox[{"b", "/", 
     RowBox[{"(", 
      RowBox[{"b", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "-", "b"}], ")"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "c"}], " ", "x"}], "]"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wjac", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}]}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"wmf", "[", 
      RowBox[{"x", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dwf", "[", 
   RowBox[{"p0_", ",", "time_", ",", "data_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"wjac", "[", 
      RowBox[{"#", ",", "p0"}], "]"}], "&"}], ",", "time"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wf", "[", 
   RowBox[{"p0_", ",", "time_", ",", "data_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"wmf", "[", 
       RowBox[{"#", ",", "p0"}], "]"}], "&"}], ",", "time"}], "]"}], "-", 
   "data"}]}]}], "Input",
 CellChangeTimes->{{3.795922427324308*^9, 3.7959224295485277`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "showplots", ",", "forecast", ",", "dpeak", ",", "expeak", ",", "lfun", ",",
    "dlfun", ",", "RMSQ"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "showplots", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"showplots", "[", 
    RowBox[{"data_", ",", "p0_", ",", "time_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dplot", ",", "wmfplot"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dplot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"time", ",", "data"}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wmfplot", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"wmf", "[", 
          RowBox[{"x", ",", "p0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"time", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"time", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", 
            RowBox[{"Length", "[", "data", "]"}]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"dplot", ",", "wmfplot", ",", 
        RowBox[{"PlotRange", "->", "All"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"showplots", "[", 
    RowBox[{"data_", ",", "p0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dplot", ",", "wmfplot", ",", "time"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"showplots", "[", 
       RowBox[{"data", ",", "p0", ",", "time"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"forecast", "[", 
   RowBox[{"data_", ",", "p0_", ",", "dd_", ",", "t0_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"wmf", "[", 
    RowBox[{
     RowBox[{"t0", "+", "dd"}], ",", "p0"}], "]"}], "-", 
   RowBox[{"wmf", "[", 
    RowBox[{"t0", ",", "p0"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"forecast", "[", 
   RowBox[{"data_", ",", "p0_", ",", "dd_"}], "]"}], ":=", 
  RowBox[{"forecast", "[", 
   RowBox[{"data", ",", "p0", ",", "dd", ",", 
    RowBox[{"Length", "[", "data", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expeak", "[", 
   RowBox[{"{", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}], "/", "b"}], "]"}], "/", 
   "c"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dpeak", "[", 
   RowBox[{"data_", ",", "ip0_", ",", "time_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"expeak", "[", "ip0", "]"}], "-", 
   RowBox[{"(", 
    RowBox[{"time", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dpeak", "[", 
   RowBox[{"data_", ",", "ip0_"}], "]"}], ":=", 
  RowBox[{"dpeak", "[", 
   RowBox[{"data", ",", "ip0", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lfun", "[", 
    RowBox[{"x_", ",", "p0_"}], "]"}], ":=", 
   RowBox[{"wmf", "[", 
    RowBox[{"x", ",", "p0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dlfun", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}]}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"lfun", "[", 
      RowBox[{"x", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], ",", "x"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RMSQ", "[", 
   RowBox[{"data_", ",", "ip0_", ",", "time_"}], "]"}], ":=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{"Mean", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"wmf", "[", 
        RowBox[{"time", ",", "ip0"}], "]"}], "-", "data"}], ")"}], "^", "2"}],
     "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RMSQ", "[", 
    RowBox[{"data_", ",", "ip0_"}], "]"}], ":=", 
   RowBox[{"RMSQ", "[", 
    RowBox[{"data", ",", "ip0", ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "GNiteration", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GNiteration", "[", 
   RowBox[{"data_", ",", "ip0_", ",", "time_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "k", ",", "tol", ",", "maxk", ",", "err", ",", "p0", ",", "np0", ",", 
      "convnot", ",", "a", ",", "b", ",", "c"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"maxk", "=", "50"}], ";", 
     RowBox[{"k", "=", "0"}], ";", 
     RowBox[{"tol", "=", 
      FractionBox["1", 
       SuperscriptBox["10", "6"]]}], ";", 
     RowBox[{"err", "=", "1"}], ";", 
     RowBox[{"p0", "=", "ip0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"convnot", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "<", "maxk"}], "&&", 
        RowBox[{"err", ">", "tol"}], "&&", 
        RowBox[{"(", 
         RowBox[{"!", "convnot"}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
         RowBox[{"p0", "-", 
          RowBox[{
           RowBox[{"PseudoInverse", "[", 
            RowBox[{"dwf", "[", 
             RowBox[{"p0", ",", "time", ",", "data"}], "]"}], "]"}], ".", 
           RowBox[{"wf", "[", 
            RowBox[{"p0", ",", "time", ",", "data"}], "]"}]}]}]}], ";", 
        RowBox[{"err", "=", 
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c"}], "}"}], "-", "p0"}], "]"}]}], 
        ";", 
        RowBox[{"p0", "=", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"convnot", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "<", 
            RowBox[{"-", 
             RowBox[{"10", "^", "6"}]}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{"a", ">", 
            RowBox[{"10", "^", "10"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{"c", "<", 
            RowBox[{"-", "100"}]}], ")"}], "||", 
          RowBox[{"c", ">", "100"}]}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"convnot", ",", 
       RowBox[{"p0", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}], ";", 
     RowBox[{"{", 
      RowBox[{"p0", ",", "k", ",", "err", ",", 
       RowBox[{"Length", "[", "data", "]"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GNiteration", "[", 
    RowBox[{"data_", ",", "ip0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "time", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"GNiteration", "[", 
       RowBox[{"data", ",", "ip0", ",", "time"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "stepGNiteration", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stepGNiteration", "[", 
    RowBox[{"data_", ",", "ip0_", ",", "lag_", ",", "time_", ",", "step_"}], 
    "]"}], ":=", 
   RowBox[{"stepGNiteration", "[", 
    RowBox[{"data", ",", "ip0", ",", "lag", ",", "time", ",", "step", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "time", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stepGNiteration", "[", 
   RowBox[{
   "data_", ",", "ip0_", ",", "lag_", ",", "time_", ",", "step_", ",", 
    "timewindow_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nres", ",", "nip0", ",", "l", ",", "abctab", ",", "windows", ",", 
      "tempdata", ",", "temptime", ",", "lb", ",", "rb", ",", "notconv", ",", 
      "firstind", ",", "lastind", ",", "outofbounds"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"nip0", "=", "ip0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lb", ",", "rb"}], "}"}], "=", "timewindow"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"Length", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"firstind", ",", "lastind"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "l"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"abctab", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"windows", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nres", "=", 
       RowBox[{"{", 
        RowBox[{"nip0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"notconv", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"nres", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"outofbounds", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lb", "+", 
           RowBox[{"step", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "<", "firstind"}], ")"}], "||", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rb", "+", 
           RowBox[{"step", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ">", "lastind"}], ")"}]}]}], 
      ";"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", ">=", "lag"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"!", "notconv"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"!", "outofbounds"}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l", "=", 
         RowBox[{"rb", "-", "lb"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tempdata", "=", 
         RowBox[{"data", "\[LeftDoubleBracket]", 
          RowBox[{"lb", ";;", "rb"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"temptime", "=", 
         RowBox[{"time", "\[LeftDoubleBracket]", 
          RowBox[{"lb", ";;", "rb"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nres", "=", 
         RowBox[{"GNiteration", "[", 
          RowBox[{"tempdata", ",", "nip0", ",", "temptime"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nip0", "=", 
         RowBox[{"nres", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"notconv", "=", 
         RowBox[{"(", 
          RowBox[{"nip0", "===", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"{", 
            RowBox[{"nres", ",", 
             RowBox[{"{", 
              RowBox[{"lb", ",", "rb"}], "}"}]}], "}"}], "]"}], ";"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"abctab", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"abctab", ",", "nip0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"windows", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"windows", ",", 
           RowBox[{"{", 
            RowBox[{"lb", ",", "rb"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lb", ",", "rb"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lb", ",", "rb"}], "}"}], "+", "step"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outofbounds", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"lb", "<", "firstind"}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{"rb", ">", "lastind"}], ")"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{"lb", ",", "rb"}], "}"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"nip0", ",", "abctab", ",", "windows"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "errorplot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errorplot", "[", 
   RowBox[{"data_", ",", "p0_", ",", "pf_", ",", "ef_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "err", ",", "dplot", ",", "len", ",", "wmfplot", ",", "upplot", ",", 
      "downplot"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"err", "=", 
      RowBox[{"RMSQ", "[", 
       RowBox[{"data", ",", "p0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"len", "=", 
      RowBox[{"Length", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dplot", "=", 
      RowBox[{"ListPlot", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"wmfplot", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"wmf", "[", 
         RowBox[{"x", ",", "p0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"pf", " ", "len"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"wmf", "[", 
             RowBox[{
              RowBox[{"pf", " ", "len"}], ",", "p0"}], "]"}], "+", 
            RowBox[{"ef", " ", "err", " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"pf", " ", "len"}], "-", "len"}], "]"}]}]}]}], "}"}]}],
         ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"upplot", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"wmf", "[", 
          RowBox[{"x", ",", "p0"}], "]"}], "+", 
         RowBox[{"ef", " ", "err", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"x", "-", "len"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "len", ",", 
          RowBox[{"pf", " ", "len"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Orange", ",", "Dashed"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"downplot", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"wmf", "[", 
          RowBox[{"x", ",", "p0"}], "]"}], "-", 
         RowBox[{"ef", " ", "err", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"x", "-", "len"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "len", ",", 
          RowBox[{"pf", " ", "len"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Orange", ",", "Dashed"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"wmfplot", ",", "upplot", ",", "dplot", ",", "downplot"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "simdata", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simdata", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l_", ",", "r_"}], "}"}], ",", "err_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "peak", ",", "tl", ",", "tr", ",", "dlplot", ",", "lplot", ",", "tabdf", 
      ",", "tabaccum", ",", "timetab"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"peak", "=", 
      RowBox[{"expeak", "[", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tl", "=", 
      RowBox[{"peak", "+", "l"}]}], ";", 
     RowBox[{"tr", "=", 
      RowBox[{"peak", "+", "r"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"tl", ",", "tr"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"tabdf", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"dlfun", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "tl", ",", "tr"}], "}"}]}], "]"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"tabdf", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"lfun", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], "-", 
         RowBox[{"lfun", "[", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "tl", ",", "tr"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"timetab", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "tl", ",", "tr"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tabaccum", "=", 
      RowBox[{
       RowBox[{"Accumulate", "[", "tabdf", "]"}], "+", 
       RowBox[{"lfun", "[", 
        RowBox[{
         RowBox[{"tl", "-", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lplot", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"lfun", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "tl", ",", "tr"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dlplot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"timetab", ",", "tabaccum"}], "}"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "lplot", ",", "dlplot", ",", "timetab", ",", "tabaccum", ",", "peak"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"lsd", ",", "plusd", ",", "minsd"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lsd", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"Log", "[", 
       FractionBox[
        RowBox[{"a", "-", "b"}], "b"], "]"}], "c"]}], "+", 
    FractionBox[
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["a", "2"], " ", "b"}], "-", 
        RowBox[{"4", " ", "a", " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["b", "3"]}], "+", 
        RowBox[{
         SqrtBox["3"], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["a", "4"], " ", 
            SuperscriptBox["b", "2"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["a", "3"], " ", 
            SuperscriptBox["b", "3"]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["b", "4"]}], "-", 
           RowBox[{"4", " ", "a", " ", 
            SuperscriptBox["b", "5"]}], "+", 
           SuperscriptBox["b", "6"]}]]}]}], 
       RowBox[{
        RowBox[{"a", " ", 
         SuperscriptBox["b", "2"]}], "-", 
        SuperscriptBox["b", "3"]}]], "]"}], "c"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plusd", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "]"}], "=", 
   FractionBox[
    RowBox[{"Log", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", "b"}], "-", 
       RowBox[{"4", " ", "a", " ", 
        SuperscriptBox["b", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["b", "3"]}], "+", 
       RowBox[{
        SqrtBox["3"], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           SuperscriptBox["a", "4"], " ", 
           SuperscriptBox["b", "2"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["a", "3"], " ", 
           SuperscriptBox["b", "3"]}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["b", "4"]}], "-", 
          RowBox[{"4", " ", "a", " ", 
           SuperscriptBox["b", "5"]}], "+", 
          SuperscriptBox["b", "6"]}]]}]}], 
      RowBox[{
       RowBox[{"a", " ", 
        SuperscriptBox["b", "2"]}], "-", 
       SuperscriptBox["b", "3"]}]], "]"}], "c"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"minsd", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "]"}], "=", 
   FractionBox[
    RowBox[{"Log", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", "b"}], "-", 
       RowBox[{"4", " ", "a", " ", 
        SuperscriptBox["b", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["b", "3"]}], "-", 
       RowBox[{
        SqrtBox["3"], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           SuperscriptBox["a", "4"], " ", 
           SuperscriptBox["b", "2"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["a", "3"], " ", 
           SuperscriptBox["b", "3"]}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["b", "4"]}], "-", 
          RowBox[{"4", " ", "a", " ", 
           SuperscriptBox["b", "5"]}], "+", 
          SuperscriptBox["b", "6"]}]]}]}], 
      RowBox[{
       RowBox[{"a", " ", 
        SuperscriptBox["b", "2"]}], "-", 
       SuperscriptBox["b", "3"]}]], "]"}], "c"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "datastats", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datastats", "[", 
   RowBox[{"data_", ",", "ip0_", ",", "tf_", ",", "sig_", ",", "time_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "error", ",", "oneday", ",", "growth", ",", "dtop", ",", "perc", ",", 
      "eplot"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eplot", "=", 
      RowBox[{"errorplot", "[", 
       RowBox[{"data", ",", "time", ",", "ip0", ",", "tf", ",", "sig"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"oneday", "=", 
      RowBox[{"forecast", "[", 
       RowBox[{"data", ",", "ip0", ",", "1", ",", 
        RowBox[{"time", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"error", "=", 
      RowBox[{"RMSQ", "[", 
       RowBox[{"data", ",", "ip0", ",", "time"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dtop", "=", 
      RowBox[{"dpeak", "[", 
       RowBox[{"data", ",", "ip0", ",", "time"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"perc", "=", 
      RowBox[{"100", " ", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "/", 
        RowBox[{"ip0", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"growth", "=", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "-", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"-", "2"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "eplot", ",", "oneday", ",", "error", ",", "growth", ",", "dtop", ",", 
       " ", "perc"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "errorplot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errorplot", "[", 
   RowBox[{"data_", ",", "time_", ",", "p0_", ",", "pf_", ",", "ef_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "err", ",", "dplot", ",", "len", ",", "wmfplot", ",", "upplot", ",", 
      "downplot", ",", "t0", ",", "tk"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"err", "=", 
      RowBox[{"RMSQ", "[", 
       RowBox[{"data", ",", "p0", ",", "time"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"len", "=", 
      RowBox[{"Length", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"t0", "=", 
      RowBox[{
       RowBox[{"time", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tk", "=", 
      RowBox[{"time", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dplot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"time", ",", "data"}], "}"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wmfplot", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"wmf", "[", 
         RowBox[{"x", ",", "p0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "t0", ",", 
          RowBox[{"t0", "+", 
           RowBox[{"pf", " ", "len"}]}]}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"wmf", "[", 
             RowBox[{
              RowBox[{"t0", "+", 
               RowBox[{"pf", " ", "len"}]}], ",", "p0"}], "]"}], "+", 
            RowBox[{"ef", " ", "err", " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"pf", " ", "len"}], "]"}]}]}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"upplot", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"wmf", "[", 
          RowBox[{"x", ",", "p0"}], "]"}], "+", 
         RowBox[{"ef", " ", "err", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"x", "-", "tk"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "tk", ",", 
          RowBox[{"tk", "+", 
           RowBox[{"pf", " ", "len"}]}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Orange", ",", "Dashed"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"downplot", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"wmf", "[", 
          RowBox[{"x", ",", "p0"}], "]"}], "-", 
         RowBox[{"ef", " ", "err", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"x", "-", "tk"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "tk", ",", 
          RowBox[{"tk", "+", 
           RowBox[{"pf", " ", "len"}]}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Orange", ",", "Dashed"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"wmfplot", ",", "upplot", ",", "dplot", ",", "downplot"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "estimates", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"estimates", "[", 
   RowBox[{"tmpdata_", ",", "tp0_", ",", "lag_", ",", "time_"}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tmp20", ",", "tgl", ",", "backres", ",", "forwp0", ",", "forres", ",", 
      "abctab", ",", "winds"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"backres", ",", "abctab", ",", "winds"}], "}"}], "=", 
      RowBox[{"stepGNiteration", "[", 
       RowBox[{"tmpdata", ",", "tp0", ",", "lag", ",", "time", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", "time", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<backward result : \>\"", ",", "backres"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"forres", ",", "abctab", ",", "winds"}], "}"}], "=", 
      RowBox[{"stepGNiteration", "[", 
       RowBox[{"tmpdata", ",", "backres", ",", 
        RowBox[{"lag", "-", "1"}], ",", "time", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "lag"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<forward result : \>\"", ",", "forres"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"abctab", ",", "winds"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "datastatsnoplot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datastatsnoplot", "[", 
   RowBox[{"data_", ",", "ip0_", ",", "time_", ",", "startdate_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "error", ",", "oneday", ",", "growth", ",", "dtop", ",", "perc"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"oneday", "=", 
      RowBox[{"forecast", "[", 
       RowBox[{"data", ",", "ip0", ",", "1", ",", 
        RowBox[{"time", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"error", "=", 
      RowBox[{"RMSQ", "[", 
       RowBox[{"data", ",", "ip0", ",", "time"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dtop", "=", 
      RowBox[{"dpeak", "[", 
       RowBox[{"data", ",", "ip0", ",", "time"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"perc", "=", 
      RowBox[{"100", " ", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "/", 
        RowBox[{"ip0", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"growth", "=", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "-", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"-", "2"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "oneday", ",", "error", ",", "growth", ",", "dtop", ",", " ", "perc", 
       ",", 
       RowBox[{"ip0", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"time", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", 
       RowBox[{"DatePlus", "[", 
        RowBox[{"startdate", ",", 
         RowBox[{"time", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "generatestats", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"generatestats", "[", 
   RowBox[{
   "data_", ",", "tp0_", ",", "lag_", ",", "time_", ",", "startdate_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tabs", ",", "twindows", ",", "allstats"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tabs", ",", "twindows"}], "}"}], "=", 
      RowBox[{"estimates", "[", 
       RowBox[{"data", ",", "tp0", ",", "lag", ",", "time"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allstats", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"datastatsnoplot", "[", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"time", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
           "startdate"}], "]"}], "&"}], ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"tabs", ",", "twindows"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"allstats", "=", 
        RowBox[{"PrependTo", "[", 
         RowBox[{"allstats", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<oneday\>\"", ",", "\"\<error\>\"", ",", "\"\<actual\>\"", 
            ",", "\"\<dtop\>\"", ",", "\"\<perc\>\""}], "}"}]}], "]"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<last tab: \>\"", ",", 
       RowBox[{"tabs", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allstats", "=", 
      RowBox[{"Transpose", "[", "allstats", "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"somegraphs", ",", "grafprojtime"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grafprojtime", "=", "21"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"somegraphs", "[", 
   RowBox[{
   "stp0_", ",", "fip0_", ",", "ttime_", ",", "tdata_", ",", "startdate_", 
    ",", "lag_", ",", "projtime_", ",", "drop_", ",", "bootlag_", ",", 
    "population_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dailyincrease", ",", "stats", ",", "oneplot", ",", "erplot", ",", 
      "projtimeinterval", ",", "dlplot", ",", "graf", ",", "logfunplot", ",", 
      "cumdinplot", ",", "loggraf", ",", "dfpplot", ",", "progress", ",", 
      "progplot", ",", "sifdate", ",", "sifplot", ",", "peakdate", ",", 
      "fifdate", ",", "ticks", ",", "ests", ",", "esterrors", ",", 
      "estminerrors", ",", "meanpasterrors", ",", "bootabctab", ",", 
      "boottimewinds", ",", "bootdatelists", ",", "tabctab", ",", "twinds", 
      ",", "dlbootplot", ",", "bootexpeakdate", ",", "bootabc", ",", 
      "bootlogfunplot", ",", "bootplot", ",", "bestfitplot", ",", 
      "pastfinalplot", ",", "popbootplot", ",", "curdatelist", ",", 
      "lfunvals", ",", "grafptimeinterval"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dailyincrease", "=", 
      RowBox[{
       RowBox[{"tdata", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], "-", 
       RowBox[{"tdata", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"stats", "=", 
      RowBox[{"generatestats", "[", 
       RowBox[{
       "tdata", ",", "stp0", ",", "lag", ",", "ttime", ",", "startdate"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tabctab", ",", "twinds"}], "}"}], "=", 
      RowBox[{"estimates", "[", 
       RowBox[{"tdata", ",", "stp0", ",", "lag", ",", "ttime"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "meanpasterrors", ",", "bootabctab", ",", "boottimewinds", ",", 
        "bootdatelists"}], "}"}], "=", 
      RowBox[{"bootstrapestimates", "[", 
       RowBox[{
       "tdata", ",", "stp0", ",", "ttime", ",", "lag", ",", "bootlag", ",", 
        "startdate", ",", "tabctab", ",", "twinds"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bootabc", "=", 
      RowBox[{"bootabctab", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sifdate", "=", 
      RowBox[{"DatePlus", "[", 
       RowBox[{"startdate", ",", 
        RowBox[{
         RowBox[{"plusd", "[", "fip0", "]"}], "-", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"peakdate", "=", 
      RowBox[{"DatePlus", "[", 
       RowBox[{"startdate", ",", 
        RowBox[{
         RowBox[{"expeak", "[", "fip0", "]"}], "-", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fifdate", "=", 
      RowBox[{"DatePlus", "[", 
       RowBox[{"startdate", ",", 
        RowBox[{
         RowBox[{"minsd", "[", "fip0", "]"}], "-", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bootexpeakdate", "=", 
      RowBox[{"DatePlus", "[", 
       RowBox[{"startdate", ",", 
        RowBox[{
         RowBox[{"expeak", "[", "bootabc", "]"}], "-", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sifdate", "=", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", 
          RowBox[{"expeak", "[", "fip0", "]"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "sifdate", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"oneplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{"dailyincrease", ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", "1"}], "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<daily increase\>\"", "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ests", "=", 
      RowBox[{"stats", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"esterrors", "=", 
      RowBox[{"stats", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"estminerrors", "=", 
      RowBox[{"ests", "-", "esterrors"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"estminerrors", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", "#"}], "]"}], "&"}], ",", "estminerrors"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"erplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ests", ",", 
          RowBox[{"ests", "+", "esterrors"}], ",", "estminerrors"}], "}"}], 
        ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", "lag"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "Red", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Orange", ",", "Dashed"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Orange", ",", "Dashed"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<daily increase estimate (at the time)\>\"", ",", 
           "\"\<estimate+expected error (at the time)\>\"", ",", 
           "\"\<estimate-expected error (at the time)\>\""}], "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"projtimeinterval", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"ttime", ",", 
         RowBox[{"Table", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"ttime", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "+", "1"}], ",", 
             RowBox[{
              RowBox[{"ttime", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "+", "projtime", "+", 
              "1"}]}], "}"}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dlplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dlfun", "[", 
            RowBox[{"#", ",", "fip0"}], "]"}], "&"}], ",", 
          "projtimeinterval"}], "]"}], ",", "startdate", ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{
         "{", "\"\<best fit projection for last 3 weeks of data\>\"", "}"}]}],
         ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", "Black", "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dlbootplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dlfun", "[", 
            RowBox[{"#", ",", "bootabc"}], "]"}], "&"}], ",", 
          "projtimeinterval"}], "]"}], ",", "startdate", ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<bootstrap projection\>\"", "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Purple", ",", "Dashed"}], "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"popbootplot", "=", 
        RowBox[{"DateListPlot", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"10", "^", "5"}], 
              RowBox[{
               RowBox[{"lfun", "[", 
                RowBox[{"#", ",", "bootabc"}], "]"}], "/", "population"}]}], 
             "&"}], ",", "ttime"}], "]"}], ",", "startdate", ",", 
          RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bootfwplots", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"bootfwplots", ",", "popbootplot"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DatePlus", "[", 
           RowBox[{"startdate", ",", "i"}], "]"}], ",", 
          RowBox[{"DateString", "[", 
           RowBox[{
            RowBox[{"DatePlus", "[", 
             RowBox[{"startdate", ",", "i"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<MonthNameShort\>\"", ",", " ", "\"\< \>\"", ",", 
              "\"\<Day\>\""}], "}"}]}], "]"}], ",", "0.02", ",", "Blue"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"ttime", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"ttime", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "+", "projtime"}], ",", "7"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"ticks", ",", 
        RowBox[{"{", 
         RowBox[{"peakdate", ",", "\"\< \>\"", ",", "0.05", ",", "Black"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"ticks", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"ticks", ",", 
          RowBox[{"{", 
           RowBox[{"fifdate", ",", "\"\<\>\"", ",", ".02", ",", "Black"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ticks", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"ticks", ",", 
          RowBox[{"{", 
           RowBox[{"sifdate", ",", "\"\<\>\"", ",", ".02", ",", "Black"}], 
           "}"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"ticks", ",", 
        RowBox[{"{", 
         RowBox[{
         "bootexpeakdate", ",", "\"\< \>\"", ",", "0.05", ",", "Purple"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sifplot", "=", 
        RowBox[{"DateListPlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"ttime", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"ttime", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          "startdate", ",", 
          RowBox[{"Ticks", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "fifdate", ",", "\"\<estimated 1. inflection\>\"", ",", ".05",
                  ",", "Red"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "peakdate", ",", "\"\<estimated peak\>\"", ",", ".05", ",", 
                 "Red"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "sifdate", ",", "\"\<estimated 2. inflection\>\"", ",", ".05",
                  ",", "Red"}], "}"}]}], "}"}], ",", "Automatic"}], "}"}]}], 
          ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"Frame", "\[Rule]", "False"}], ",", 
          RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sifplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"ttime", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"ttime", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        "startdate", ",", 
        RowBox[{"Ticks", "->", 
         RowBox[{"{", 
          RowBox[{"ticks", ",", "Automatic"}], "}"}]}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"Frame", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Thick"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"projtimeinterval", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"projtimeinterval", ",", "drop"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"logfunplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lfun", "[", 
            RowBox[{"#", ",", "fip0"}], "]"}], "&"}], ",", 
          "projtimeinterval"}], "]"}], ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", "drop"}], "]"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{
         "{", "\"\<best fit projection for last 3 weeks of data\>\"", "}"}]}],
         ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bootlogfunplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lfun", "[", 
            RowBox[{"#", ",", "bootabc"}], "]"}], "&"}], ",", 
          "projtimeinterval"}], "]"}], ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", "drop"}], "]"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<bootstrap projection\>\"", "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Purple", ",", "Dashed"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cumdinplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{"tdata", ",", "startdate", ",", 
        RowBox[{"Joined", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<total confirmed cases\>\"", "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{"PointSize", "[", "0.015", "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"loggraf", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"logfunplot", ",", "bootlogfunplot", ",", "cumdinplot", ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
        RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dfpplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", 
          RowBox[{"stats", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", "lag"}], "]"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{
         "{", "\"\<estimated days from peak (at the time)\>\"", "}"}]}], ",", 
        
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Blue", ",", 
           RowBox[{"PointSize", "[", "0.010", "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"progress", "=", 
      RowBox[{"stats", "[", 
       RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"progplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"{", "progress", "}"}], ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", "lag"}], "]"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<estimated progress (at the time)\>\"", "}"}]}], 
        ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Blue", ",", 
           RowBox[{"PointSize", "[", "0.010", "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"graf", "=", 
      RowBox[{"Show", "[", 
       RowBox[{
       "sifplot", ",", "dlplot", ",", "dlbootplot", ",", "oneplot", ",", 
        "erplot", ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bootplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"bootdatelists", ",", 
           RowBox[{
            RowBox[{"Transpose", "[", "bootabctab", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Purple", ",", "Dashed"}], "}"}]}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{
         "{", "\"\<bootstrap estimates for final number of cases (at the \
time)\>\"", "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bestfitplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "tabctab", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", 
          RowBox[{"ttime", "[", 
           RowBox[{"[", "lag", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{
         "{", "\"\<best fit estimates for final number of cases (at the time)\
\>\"", "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pastfinalplot", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"bestfitplot", ",", "bootplot", ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<boostrap estimates : \>\"", ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"bootdatelists", ",", 
             RowBox[{
              RowBox[{"Transpose", "[", "bootabctab", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"grafptimeinterval", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ttime", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "1", "+", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "ttime", "]"}], "+", "grafprojtime"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"curdatelist", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DatePlus", "[", 
          RowBox[{"startdate", ",", "#"}], "]"}], "&"}], ",", 
        "grafptimeinterval"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "ttime", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"lfunvals", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"10", "^", "5"}], 
          RowBox[{
           RowBox[{"lfun", "[", 
            RowBox[{"#", ",", "bootabc"}], "]"}], "/", "population"}]}], 
         "&"}], ",", "grafptimeinterval"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"countrybootabcs", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"countrybootabcs", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"curdatelist", ",", "lfunvals"}], "}"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "graf", ",", "loggraf", ",", "dfpplot", ",", "progplot", ",", 
       "pastfinalplot", ",", "bootabc"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reldatetostring", "[", 
   RowBox[{"startdate_", ",", "tplus_"}], "]"}], ":=", 
  RowBox[{"DateString", "[", 
   RowBox[{
    RowBox[{"DatePlus", "[", 
     RowBox[{"startdate", ",", "tplus"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<MonthName\>\"", ",", "\"\< \>\"", ",", "\"\<Day\>\""}], 
     "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "updater", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"updater", "[", 
   RowBox[{
   "tbootpdata_", ",", "tbootfdata_", ",", "tbootptime_", ",", "tbootftime_", 
    ",", "abc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "a0", ",", "r2", ",", "r3", ",", "r4", ",", "tdata", ",", 
      "ttime"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a0", "=", "abc"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tdata", "=", "tbootpdata"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ttime", "=", "tbootptime"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "tbootfdata", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tdata", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"tdata", ",", 
           RowBox[{"tbootfdata", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ttime", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"ttime", ",", 
           RowBox[{"tbootftime", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a0", ",", "r2", ",", "r3", ",", "r4"}], "}"}], "=", 
         RowBox[{"GNiteration", "[", 
          RowBox[{"tdata", ",", "a0", ",", "ttime"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "a0", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "a0"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "bootstrapestimates", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bootstrapestimates", "[", 
   RowBox[{
   "tmpdata_", ",", "tp0_", ",", "ttime_", ",", "lag_", ",", "winl_", ",", 
    "startdate_", ",", "tabctab_", ",", "twinds_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "labcind", ",", "cabcind", ",", "rabcind", ",", "pastdata", ",", 
      "pasttime", ",", "futtime", ",", "pftime", ",", "curabc", ",", 
      "pastabc", ",", "pastests", ",", "pasterrors", ",", "sabcind", ",", 
      "meanpasterrors", ",", "sabcdatelist", ",", "pabcdatelist", ",", 
      "cbootabc", ",", "tbootptime", ",", "tbootime", ",", "tbootpdata", ",", 
      "sabc0", ",", "tbootfdata", ",", "biniterr", ",", "tbootdata", ",", 
      "bootabctab", ",", "boottimewinds", ",", "bootdatelists"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sabcind", "=", 
      RowBox[{"lag", "+", "winl"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bootabctab", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"boottimewinds", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bootdatelists", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tabctab", ",", "twinds"}], "}"}], "=", 
        RowBox[{"estimates", "[", 
         RowBox[{"tmpdata", ",", "tp0", ",", "lag", ",", "ttime"}], "]"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"meanpasterrors", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<time: \>\"", ",", "ttime"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"sabcind", "<=", 
        RowBox[{"Length", "[", "ttime", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"labcind", ",", "cabcind", ",", "rabcind"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sabcind", "-", "winl", "+", "1"}], ",", "sabcind", ",", 
           RowBox[{"sabcind", "+", "winl"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pastdata", "=", 
         RowBox[{"tmpdata", "[", 
          RowBox[{"[", 
           RowBox[{"labcind", ";;", "cabcind"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pasttime", "=", 
         RowBox[{"ttime", "[", 
          RowBox[{"[", 
           RowBox[{"labcind", ";;", "cabcind"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"futtime", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"cabcind", "+", "1"}], ",", "rabcind"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pftime", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"pasttime", ",", "futtime"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"curabc", "=", 
         RowBox[{"tabctab", "[", 
          RowBox[{"[", 
           RowBox[{"cabcind", "-", "lag", "+", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pastabc", "=", 
         RowBox[{"tabctab", "[", 
          RowBox[{"[", 
           RowBox[{"cabcind", "-", "lag", "-", "winl", "+", "1"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pastests", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"wmf", "[", 
             RowBox[{"#", ",", "pastabc"}], "]"}], "&"}], ",", "pasttime"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pasterrors", "=", 
         RowBox[{"pastdata", "-", "pastests"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<mean :\>\"", ",", "sabcind", ",", 
             RowBox[{"DatePlus", "[", 
              RowBox[{"startdate", ",", 
               RowBox[{"pasttime", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Mean", "[", "pasterrors", "]"}]}], "}"}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pabcdatelist", "=", 
         RowBox[{"DatePlus", "[", 
          RowBox[{"startdate", ",", "labcind"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"meanpasterrors", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"meanpasterrors", ",", 
             RowBox[{"{", 
              RowBox[{"pabcdatelist", ",", 
               RowBox[{"Mean", "[", "pasterrors", "]"}]}], "}"}]}], "]"}]}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"meanpasterrors", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"meanpasterrors", ",", 
           RowBox[{"{", 
            RowBox[{"pabcdatelist", ",", 
             RowBox[{
              RowBox[{"pasterrors", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "/", "winl"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tbootptime", "=", 
         RowBox[{"ttime", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"sabcind", "-", "lag", "+", "1"}], ";;", "sabcind"}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tbootime", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"tbootptime", ",", "futtime"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"tbootdata", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"wmf", "[", 
               RowBox[{"#", ",", "pastabc"}], "]"}], "&"}], ",", "tbootime"}],
             "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tbootpdata", "=", 
         RowBox[{"tmpdata", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"sabcind", "-", "lag", "+", "1"}], ";;", "sabcind"}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sabc0", "=", "curabc"}], ";", "\[IndentingNewLine]", 
        RowBox[{"biniterr", "=", 
         RowBox[{
          RowBox[{"tbootpdata", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "-", 
          RowBox[{"wmf", "[", 
           RowBox[{
            RowBox[{"tbootptime", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], ",", "sabc0"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tbootfdata", "=", 
         RowBox[{"biniterr", "+", "pasterrors", "+", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"wmf", "[", 
              RowBox[{"#", ",", "sabc0"}], "]"}], "&"}], ",", "futtime"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tbootdata", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"tbootpdata", ",", "tbootfdata"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tbootime", ",", "tbootdata"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"sabcind", ",", "sabc0", ",", "biniterr", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Length", "[", "tbootime", "]"}], ",", 
                RowBox[{"Length", "[", "tbootdata", "]"}]}], "}"}]}], "}"}]}],
            "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"cbootabc", "=", 
         RowBox[{"updater", "[", 
          RowBox[{
          "tbootpdata", ",", "tbootfdata", ",", "tbootptime", ",", "futtime", 
           ",", "sabc0"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sabcdatelist", "=", 
         RowBox[{"DatePlus", "[", 
          RowBox[{"startdate", ",", "cabcind"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bootabctab", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"bootabctab", ",", "cbootabc"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"boottimewinds", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"boottimewinds", ",", 
           RowBox[{"tbootptime", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bootdatelists", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"bootdatelists", ",", "sabcdatelist"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"{", 
            RowBox[{"sabcdatelist", ",", "cbootabc"}], "}"}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"sabcind", "=", 
         RowBox[{"sabcind", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<past errors : \>\"", " ", ",", 
       RowBox[{"{", 
        RowBox[{"pasterrors", ",", 
         RowBox[{"Mean", "[", "pasterrors", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<boot tab : \>\"", " ", ",", "bootabctab"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"{", 
       RowBox[{
       "meanpasterrors", ",", "tbootpdata", ",", "tbootfdata", ",", "futtime",
         ",", "tbootfdata", ",", "sabc0"}], "}"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "meanpasterrors", ",", "bootabctab", ",", "boottimewinds", ",", 
       "bootdatelists"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "somegraphs2", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"somegraphs2", "[", 
   RowBox[{
   "stp0_", ",", "fip0_", ",", "ttime_", ",", "tdata_", ",", "startdate_", 
    ",", "lag_", ",", "projtime_", ",", "drop_", ",", "bootlag_", ",", 
    "population_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dailyincrease", ",", "stats", ",", "oneplot", ",", "erplot", ",", 
      "projtimeinterval", ",", "dlplot", ",", "graf", ",", "logfunplot", ",", 
      "cumdinplot", ",", "loggraf", ",", "dfpplot", ",", "progress", ",", 
      "progplot", ",", "sifdate", ",", "sifplot", ",", "peakdate", ",", 
      "fifdate", ",", "ticks", ",", "ests", ",", "esterrors", ",", 
      "estminerrors", ",", "meanpasterrors", ",", "bootabctab", ",", 
      "boottimewinds", ",", "bootdatelists", ",", "tabctab", ",", "twinds", 
      ",", "dlbootplot", ",", "bootexpeakdate", ",", "bootabc", ",", 
      "bootlogfunplot", ",", "bootplot", ",", "bestfitplot", ",", 
      "pastfinalplot", ",", "popbootplot", ",", "curdatelist", ",", 
      "lfunvals", ",", "grafptimeinterval", ",", "stlogfunplot", ",", 
      "threeweektimeinterval", ",", "lagstarttime", ",", "lagstartdate", ",", 
      "stdlplot"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dailyincrease", "=", 
      RowBox[{
       RowBox[{"tdata", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], "-", 
       RowBox[{"tdata", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"stats", "=", 
      RowBox[{"generatestats", "[", 
       RowBox[{
       "tdata", ",", "stp0", ",", "lag", ",", "ttime", ",", "startdate"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tabctab", ",", "twinds"}], "}"}], "=", 
      RowBox[{"estimates", "[", 
       RowBox[{"tdata", ",", "stp0", ",", "lag", ",", "ttime"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "meanpasterrors", ",", "bootabctab", ",", "boottimewinds", ",", 
        "bootdatelists"}], "}"}], "=", 
      RowBox[{"bootstrapestimates", "[", 
       RowBox[{
       "tdata", ",", "stp0", ",", "ttime", ",", "lag", ",", "bootlag", ",", 
        "startdate", ",", "tabctab", ",", "twinds"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bootabc", "=", 
      RowBox[{"bootabctab", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sifdate", "=", 
      RowBox[{"DatePlus", "[", 
       RowBox[{"startdate", ",", 
        RowBox[{
         RowBox[{"plusd", "[", "fip0", "]"}], "-", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"peakdate", "=", 
      RowBox[{"DatePlus", "[", 
       RowBox[{"startdate", ",", 
        RowBox[{
         RowBox[{"expeak", "[", "fip0", "]"}], "-", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fifdate", "=", 
      RowBox[{"DatePlus", "[", 
       RowBox[{"startdate", ",", 
        RowBox[{
         RowBox[{"minsd", "[", "fip0", "]"}], "-", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bootexpeakdate", "=", 
      RowBox[{"DatePlus", "[", 
       RowBox[{"startdate", ",", 
        RowBox[{
         RowBox[{"expeak", "[", "bootabc", "]"}], "-", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sifdate", "=", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", 
          RowBox[{"expeak", "[", "fip0", "]"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "sifdate", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"oneplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{"dailyincrease", ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", "1"}], "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<daily increase\>\"", "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ests", "=", 
      RowBox[{"stats", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"esterrors", "=", 
      RowBox[{"stats", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"estminerrors", "=", 
      RowBox[{"ests", "-", "esterrors"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"estminerrors", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", "#"}], "]"}], "&"}], ",", "estminerrors"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"erplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ests", ",", 
          RowBox[{"ests", "+", "esterrors"}], ",", "estminerrors"}], "}"}], 
        ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", "lag"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "Red", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Orange", ",", "Dashed"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Orange", ",", "Dashed"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<daily increase estimate (at the time)\>\"", ",", 
           "\"\<estimate+expected error (at the time)\>\"", ",", 
           "\"\<estimate-expected error (at the time)\>\""}], "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"projtimeinterval", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"ttime", ",", 
         RowBox[{"Table", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"ttime", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "+", "1"}], ",", 
             RowBox[{
              RowBox[{"ttime", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "+", "projtime", "+", 
              "1"}]}], "}"}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lagstarttime", "=", 
      RowBox[{"ttime", "[", 
       RowBox[{"[", 
        RowBox[{"-", "lag"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lagstartdate", "=", 
      RowBox[{"DatePlus", "[", 
       RowBox[{"startdate", ",", "lagstarttime"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"threeweektimeinterval", "=", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"ttime", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "lag"}], ";;"}], "]"}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"ttime", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "+", "1"}], ",", 
             RowBox[{
              RowBox[{"ttime", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "+", "projtime", "+", 
              "1"}]}], "}"}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdlplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dlfun", "[", 
            RowBox[{"#", ",", "stp0"}], "]"}], "&"}], ",", 
          "projtimeinterval"}], "]"}], ",", "startdate", ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<best fit for all past data\>\"", "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", "Black", "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dlplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dlfun", "[", 
            RowBox[{"#", ",", "fip0"}], "]"}], "&"}], ",", 
          "threeweektimeinterval"}], "]"}], ",", "lagstartdate", ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{
         "{", "\"\<best fit projection for last 3 weeks of data\>\"", "}"}]}],
         ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", "Green", "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dlbootplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dlfun", "[", 
            RowBox[{"#", ",", "bootabc"}], "]"}], "&"}], ",", 
          "threeweektimeinterval"}], "]"}], ",", "lagstartdate", ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<bootstrap projection\>\"", "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Purple", ",", "Dashed"}], "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"popbootplot", "=", 
        RowBox[{"DateListPlot", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"10", "^", "5"}], 
              RowBox[{
               RowBox[{"lfun", "[", 
                RowBox[{"#", ",", "bootabc"}], "]"}], "/", "population"}]}], 
             "&"}], ",", "ttime"}], "]"}], ",", "startdate", ",", 
          RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bootfwplots", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"bootfwplots", ",", "popbootplot"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DatePlus", "[", 
           RowBox[{"startdate", ",", "i"}], "]"}], ",", 
          RowBox[{"DateString", "[", 
           RowBox[{
            RowBox[{"DatePlus", "[", 
             RowBox[{"startdate", ",", "i"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<MonthNameShort\>\"", ",", " ", "\"\< \>\"", ",", 
              "\"\<Day\>\""}], "}"}]}], "]"}], ",", "0.02", ",", "Blue"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"ttime", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"ttime", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "+", "projtime"}], ",", "7"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"ticks", ",", 
        RowBox[{"{", 
         RowBox[{"peakdate", ",", "\"\< \>\"", ",", "0.05", ",", "Black"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"ticks", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"ticks", ",", 
          RowBox[{"{", 
           RowBox[{"fifdate", ",", "\"\<\>\"", ",", ".02", ",", "Black"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ticks", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"ticks", ",", 
          RowBox[{"{", 
           RowBox[{"sifdate", ",", "\"\<\>\"", ",", ".02", ",", "Black"}], 
           "}"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"ticks", ",", 
        RowBox[{"{", 
         RowBox[{
         "bootexpeakdate", ",", "\"\< \>\"", ",", "0.05", ",", "Purple"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sifplot", "=", 
        RowBox[{"DateListPlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"ttime", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"ttime", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          "startdate", ",", 
          RowBox[{"Ticks", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "fifdate", ",", "\"\<estimated 1. inflection\>\"", ",", ".05",
                  ",", "Red"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "peakdate", ",", "\"\<estimated peak\>\"", ",", ".05", ",", 
                 "Red"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "sifdate", ",", "\"\<estimated 2. inflection\>\"", ",", ".05",
                  ",", "Red"}], "}"}]}], "}"}], ",", "Automatic"}], "}"}]}], 
          ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"Frame", "\[Rule]", "False"}], ",", 
          RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sifplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"ttime", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"ttime", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        "startdate", ",", 
        RowBox[{"Ticks", "->", 
         RowBox[{"{", 
          RowBox[{"ticks", ",", "Automatic"}], "}"}]}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"Frame", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Thick"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"projtimeinterval", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"projtimeinterval", ",", "drop"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"threeweektimeinterval", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"threeweektimeinterval", ",", "drop"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stlogfunplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lfun", "[", 
            RowBox[{"#", ",", "stp0"}], "]"}], "&"}], ",", 
          "projtimeinterval"}], "]"}], ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", "drop"}], "]"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<best fit for all data\>\"", "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"logfunplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lfun", "[", 
            RowBox[{"#", ",", "fip0"}], "]"}], "&"}], ",", 
          "threeweektimeinterval"}], "]"}], ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"lagstartdate", ",", "drop"}], "]"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{
         "{", "\"\<best fit projection for last 3 weeks of data\>\"", "}"}]}],
         ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bootlogfunplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lfun", "[", 
            RowBox[{"#", ",", "bootabc"}], "]"}], "&"}], ",", 
          "threeweektimeinterval"}], "]"}], ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"lagstartdate", ",", "drop"}], "]"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<bootstrap projection\>\"", "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Purple", ",", "Dashed"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cumdinplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{"tdata", ",", "startdate", ",", 
        RowBox[{"Joined", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<total confirmed cases\>\"", "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{"PointSize", "[", "0.015", "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"loggraf", "=", 
      RowBox[{"Show", "[", 
       RowBox[{
       "stlogfunplot", ",", "logfunplot", ",", "bootlogfunplot", ",", 
        "cumdinplot", ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
        RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dfpplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", 
          RowBox[{"stats", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", "lag"}], "]"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{
         "{", "\"\<estimated days from peak (at the time)\>\"", "}"}]}], ",", 
        
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Blue", ",", 
           RowBox[{"PointSize", "[", "0.010", "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"progress", "=", 
      RowBox[{"stats", "[", 
       RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"progplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"{", "progress", "}"}], ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", "lag"}], "]"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<estimated progress (at the time)\>\"", "}"}]}], 
        ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Blue", ",", 
           RowBox[{"PointSize", "[", "0.010", "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"graf", "=", 
      RowBox[{"Show", "[", 
       RowBox[{
       "sifplot", ",", "stdlplot", ",", "dlplot", ",", "dlbootplot", ",", 
        "oneplot", ",", "erplot", ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bootplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"bootdatelists", ",", 
           RowBox[{
            RowBox[{"Transpose", "[", "bootabctab", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Purple", ",", "Dashed"}], "}"}]}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{
         "{", "\"\<bootstrap estimates for final number of cases (at the \
time)\>\"", "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bestfitplot", "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "tabctab", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"DatePlus", "[", 
         RowBox[{"startdate", ",", 
          RowBox[{"ttime", "[", 
           RowBox[{"[", "lag", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{
         "{", "\"\<best fit estimates for final number of cases (at the time)\
\>\"", "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pastfinalplot", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"bestfitplot", ",", "bootplot", ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<boostrap estimates : \>\"", ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"bootdatelists", ",", 
             RowBox[{
              RowBox[{"Transpose", "[", "bootabctab", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"grafptimeinterval", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ttime", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "1", "+", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "ttime", "]"}], "+", "grafprojtime"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"curdatelist", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DatePlus", "[", 
          RowBox[{"startdate", ",", "#"}], "]"}], "&"}], ",", 
        "grafptimeinterval"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "ttime", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"lfunvals", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"10", "^", "5"}], 
          RowBox[{
           RowBox[{"lfun", "[", 
            RowBox[{"#", ",", "bootabc"}], "]"}], "/", "population"}]}], 
         "&"}], ",", "grafptimeinterval"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"countrybootabcs", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"countrybootabcs", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"curdatelist", ",", "lfunvals"}], "}"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"fip0", "[", 
          RowBox[{"[", "1", "]"}], "]"}], 
         RowBox[{
          RowBox[{"10", "^", "5"}], "/", "population"}]}], ">", 
        "grafthreshhold"}], ",", "\[IndentingNewLine]", 
       RowBox[{"morecountrybootabcs", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"morecountrybootabcs", ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"curdatelist", ",", "lfunvals"}], "}"}], "]"}]}], "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"lesscountrybootabcs", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"lesscountrybootabcs", ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"curdatelist", ",", "lfunvals"}], "}"}], "]"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"{", 
      RowBox[{
      "graf", ",", "loggraf", ",", "dfpplot", ",", "progplot", ",", 
       "pastfinalplot", ",", "bootabc"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grafthreshhold", "=", "100"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.795524361302558*^9, 3.7955243617659187`*^9}, {
   3.795580219414031*^9, 3.795580248958391*^9}, {3.795661074153103*^9, 
   3.795661074438863*^9}, {3.7956707847568274`*^9, 3.795670785276594*^9}, {
   3.795670857109371*^9, 3.79567085786701*^9}, {3.795670907188085*^9, 
   3.7956709075091677`*^9}, {3.7956710457587957`*^9, 3.795671055433222*^9}, {
   3.795671115551716*^9, 3.795671169473908*^9}, {3.7956810628792267`*^9, 
   3.795681063106635*^9}, {3.795696032183914*^9, 3.79569604657055*^9}, {
   3.7956964714678717`*^9, 3.795696471707281*^9}, {3.795696503793777*^9, 
   3.795696507831696*^9}, 3.795745269837139*^9, 3.795762232709909*^9, 
   3.795763366150485*^9, {3.79576384000795*^9, 3.795763842052596*^9}, {
   3.795763892372123*^9, 3.795763893617606*^9}, {3.7957639259642477`*^9, 
   3.795763942580172*^9}, {3.795763986091942*^9, 3.7957639872395277`*^9}, {
   3.7957759221014223`*^9, 3.795775922768532*^9}, {3.7957760907301207`*^9, 
   3.795776100122858*^9}, {3.795776134928825*^9, 3.795776139271668*^9}, {
   3.795776195082571*^9, 3.795776226701426*^9}, {3.795776576398604*^9, 
   3.795776615208219*^9}, {3.7957767669055567`*^9, 3.7957767900146914`*^9}, {
   3.7957768369852657`*^9, 3.79577687478398*^9}, {3.795776913697855*^9, 
   3.795776923949876*^9}, {3.795777004949133*^9, 3.79577704855686*^9}, {
   3.79577723818591*^9, 3.7957772923754253`*^9}, 3.79577874868543*^9, {
   3.7957799227054*^9, 3.795779937263454*^9}, {3.795780426595375*^9, 
   3.795780431081386*^9}, {3.795788657566733*^9, 3.795788661914196*^9}, 
   3.795919840139208*^9, 3.795919921450068*^9, {3.795919977290882*^9, 
   3.795920052981987*^9}, {3.795920105785375*^9, 3.795920106304001*^9}, {
   3.795920191721085*^9, 3.7959201928088818`*^9}, {3.795920521971746*^9, 
   3.795920522422805*^9}, {3.795920661428006*^9, 3.79592066500819*^9}, {
   3.7959207064109173`*^9, 3.7959207112485113`*^9}, {3.7959207837322197`*^9, 
   3.79592079552205*^9}, 3.795921449969446*^9, 3.795924079546891*^9, {
   3.7959249221405993`*^9, 3.7959249411039124`*^9}, {3.795929258386469*^9, 
   3.795929274523964*^9}, 3.7959298022135983`*^9, 3.795931431820438*^9, 
   3.7959319464668713`*^9, {3.795955196619076*^9, 3.795955196923862*^9}, {
   3.795955239275797*^9, 3.795955305226947*^9}, {3.7959556079062567`*^9, 
   3.7959556094664783`*^9}, {3.7959557923657207`*^9, 3.795955793224494*^9}, 
   3.796057816174506*^9, {3.79605785065757*^9, 3.796057853732345*^9}, 
   3.796284927405417*^9, {3.7962851812952414`*^9, 3.796285203886079*^9}, {
   3.7962994518500843`*^9, 3.796299454647614*^9}, {3.796299534310623*^9, 
   3.796299536571842*^9}, {3.796300395769856*^9, 3.796300399698522*^9}, {
   3.796300583189992*^9, 3.7963006280173607`*^9}, {3.796301103746923*^9, 
   3.796301112687849*^9}, {3.796352435895669*^9, 3.796352436240193*^9}, {
   3.796381350711877*^9, 3.796381353610654*^9}, {3.796381563154264*^9, 
   3.796381565557893*^9}, {3.796525319512313*^9, 3.796525371254779*^9}, {
   3.7965254012707987`*^9, 3.796525405592239*^9}, {3.796525470536319*^9, 
   3.796525485738287*^9}, {3.796526679967675*^9, 3.796526692894705*^9}, {
   3.796556250332879*^9, 3.796556268023013*^9}, {3.796557115740424*^9, 
   3.79655712024505*^9}, {3.796557584187448*^9, 3.7965575845354853`*^9}, 
   3.796557941645282*^9, {3.796562965382596*^9, 3.796563051797716*^9}, 
   3.796563665243691*^9, {3.79656371628328*^9, 3.7965637867500687`*^9}, {
   3.796563843321333*^9, 3.796563920352017*^9}, {3.796564566884225*^9, 
   3.796564630773793*^9}, {3.796564709740082*^9, 3.796564790226201*^9}, {
   3.796564832608211*^9, 3.796564930783017*^9}, {3.796564972293859*^9, 
   3.796565018239634*^9}, {3.796566393957137*^9, 3.796566477322525*^9}, {
   3.796566518293762*^9, 3.7965665503713093`*^9}, {3.796566582732318*^9, 
   3.796566616281481*^9}, {3.796566696779634*^9, 3.7965667433995323`*^9}, {
   3.7965737281218843`*^9, 3.796573751600486*^9}, {3.796573847539383*^9, 
   3.796573876314705*^9}, {3.796573985501651*^9, 3.79657411865657*^9}, {
   3.796574171433935*^9, 3.796574207013159*^9}, {3.796575386285654*^9, 
   3.7965754220241013`*^9}, {3.796575469314386*^9, 3.796575575534129*^9}, {
   3.79657564437658*^9, 3.796575667042197*^9}, {3.796575755275722*^9, 
   3.796575825843536*^9}, {3.796575936510215*^9, 3.796575963880905*^9}, {
   3.796576156926784*^9, 3.796576183300149*^9}, {3.796576213821561*^9, 
   3.7965762504855623`*^9}, 3.796576286556529*^9, {3.796576350987451*^9, 
   3.79657653217346*^9}, {3.796576582726972*^9, 3.796576609318869*^9}, {
   3.796576649475033*^9, 3.796576650549242*^9}, {3.796576715468013*^9, 
   3.796576736675946*^9}, {3.796576951624319*^9, 3.796577019170313*^9}, {
   3.7965770955261507`*^9, 3.796577096417935*^9}, {3.796577152570105*^9, 
   3.796577157376021*^9}, {3.796577820422229*^9, 3.7965778221351633`*^9}, {
   3.796577858490424*^9, 3.796577863305887*^9}, {3.7965789005457487`*^9, 
   3.796578934893783*^9}, {3.796578977747978*^9, 3.796579285037957*^9}, {
   3.796584441462489*^9, 3.796584448805458*^9}, 3.7965844803219557`*^9, {
   3.7966078401792917`*^9, 3.7966078517564907`*^9}, {3.796607972563982*^9, 
   3.796607977770504*^9}, {3.796608042499446*^9, 3.796608184018515*^9}, {
   3.796610498116797*^9, 3.796610598015325*^9}, {3.79661069083918*^9, 
   3.7966108016049*^9}, {3.7966108621024637`*^9, 3.7966109419670753`*^9}, {
   3.796611003750371*^9, 3.7966110536684713`*^9}, 3.796611316411949*^9, {
   3.7966113757353153`*^9, 3.796611423726377*^9}, {3.7966115793332987`*^9, 
   3.796611781714275*^9}, {3.796611828526507*^9, 3.7966118311630907`*^9}, {
   3.796611868563758*^9, 3.79661192588139*^9}, {3.796612160252984*^9, 
   3.796612169423246*^9}, {3.796612280248992*^9, 3.7966122886410503`*^9}, {
   3.796612319489588*^9, 3.796612430186496*^9}, 3.796612590427682*^9, {
   3.7966126563520184`*^9, 3.796612716743381*^9}, {3.79661278455799*^9, 
   3.796612844468525*^9}, {3.796612910407384*^9, 3.796613151700362*^9}, {
   3.796613181874158*^9, 3.7966131980897503`*^9}, {3.7966132300690804`*^9, 
   3.796613276795582*^9}, {3.796613659129554*^9, 3.796613739399351*^9}, {
   3.796613778836297*^9, 3.796613791507166*^9}, {3.796613873082617*^9, 
   3.796613879414928*^9}, {3.796613940967525*^9, 3.796613970352593*^9}, {
   3.7966142231218987`*^9, 3.796614223853396*^9}, {3.796614288313362*^9, 
   3.796614302332797*^9}, {3.796614347313308*^9, 3.796614607301009*^9}, {
   3.796614715605345*^9, 3.796614726969122*^9}, {3.796615434920123*^9, 
   3.7966154482233152`*^9}, {3.796784265056263*^9, 3.7967842885312347`*^9}, {
   3.7967850572909803`*^9, 3.7967851497225027`*^9}, {3.796785205392571*^9, 
   3.796785208747842*^9}, 3.796785240206842*^9, {3.7967852817052727`*^9, 
   3.796785283481214*^9}, 3.796785318845146*^9, {3.7967853818551283`*^9, 
   3.79678538502155*^9}, {3.79678542578529*^9, 3.7967854350886517`*^9}, {
   3.796785516145566*^9, 3.796785557274433*^9}, {3.7967856536864023`*^9, 
   3.796785671117674*^9}, {3.796785728588891*^9, 3.7967857761143847`*^9}, {
   3.7967858509997396`*^9, 3.796785854353629*^9}, {3.796785909406337*^9, 
   3.796785912267631*^9}, {3.79681227173059*^9, 3.7968122825845823`*^9}, {
   3.796812612169373*^9, 3.7968127229617434`*^9}, 3.796812762432663*^9, {
   3.7968128008214397`*^9, 3.7968128194487057`*^9}, {3.796812918289238*^9, 
   3.7968129192830763`*^9}, {3.796813023933566*^9, 3.796813031036366*^9}, {
   3.796813180577916*^9, 3.7968131819049397`*^9}, {3.796813459370504*^9, 
   3.796813462996036*^9}, {3.7968141680425167`*^9, 3.796814215430429*^9}, {
   3.796820549286993*^9, 3.7968206547242937`*^9}, {3.796820836196953*^9, 
   3.796820844543833*^9}, {3.7968212172214403`*^9, 3.796821218693651*^9}, 
   3.796833658953548*^9, {3.796870378841695*^9, 3.796870396820088*^9}, {
   3.79687043685292*^9, 3.796870526327259*^9}, {3.796870691150457*^9, 
   3.796870750686104*^9}, {3.796871148046489*^9, 3.796871148183957*^9}, {
   3.796872539277424*^9, 3.796872546906768*^9}, 3.796875868596677*^9, 
   3.796875901255398*^9, {3.796877541845615*^9, 3.796877541975975*^9}, {
   3.796879702469882*^9, 3.796879704983697*^9}, {3.7968797364856873`*^9, 
   3.796879741385458*^9}, 3.796880147775312*^9, {3.7968895427000637`*^9, 
   3.796889546858634*^9}, {3.796889748008889*^9, 3.79688975218592*^9}, {
   3.7968899754080267`*^9, 3.796889975769368*^9}, {3.796891441332287*^9, 
   3.796891441859468*^9}, {3.7968943464919567`*^9, 3.796894368231172*^9}, {
   3.796974438817933*^9, 3.796974457681243*^9}, {3.797562150320579*^9, 
   3.79756215132263*^9}, {3.797562416667664*^9, 3.7975624521802263`*^9}, {
   3.7975625163681707`*^9, 3.7975626006800957`*^9}, {3.797563411699988*^9, 
   3.797563428717804*^9}, {3.7975642277859383`*^9, 3.797564227888878*^9}, {
   3.797571309024639*^9, 3.797571314351924*^9}}]
},
WindowSize->{610, 577},
WindowMargins->{{0, Automatic}, {Automatic, 29}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1685, 56, 97, "Input"],
Cell[2246, 78, 102662, 2563, 9438, "Input"]
}
]
*)

(* End of internal cache information *)
